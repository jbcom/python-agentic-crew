# Tox configuration for agentic-crew workspace
# Runs tests across all packages
# Uses tox-uv for uv workspace integration and tox-gh for GitHub Actions

[tox]
requires =
    tox>=4.11
    tox-uv>=1.11
    tox-gh>=1.3
env_list =
    py311,py312,py313
    lint
min_version = 4.11
skip_missing_interpreters = true

[gh]
python =
    3.11 = py311
    3.12 = py312
    3.13 = py313

# Base test environment
[testenv]
package = skip
deps =
    pytest>=9.0.0
    pytest-cov>=5.0.0
    pytest-mock>=3.15.0
    pytest-asyncio>=0.23.0
    {toxinidir}/packages/agentic-crew[tests,crewai]
    {toxinidir}/packages/pytest-agentic-crew
changedir = {toxinidir}
commands =
    pytest tests {posargs}

# Individual package environments
[testenv:agentic-crew]
changedir = {toxinidir}
deps =
    {toxinidir}/packages/agentic-crew[tests,crewai]
    {toxinidir}/packages/pytest-agentic-crew
commands = pytest tests --ignore=tests/e2e {posargs}

[testenv:pytest-agentic-crew]
changedir = {toxinidir}/packages/pytest-agentic-crew
deps = {toxinidir}/packages/pytest-agentic-crew
commands = pytest -v {posargs}

# Lint all packages
[testenv:lint]
skip_install = true
deps = ruff>=0.8.0
commands =
    ruff check packages/
    ruff check tests/
    ruff format --check packages/
    ruff format --check tests/

# Build documentation
[testenv:docs]
changedir = {toxinidir}
deps =
    sphinx>=7.0.0
    sphinx-rtd-theme>=2.0.0
    sphinx-autodoc-typehints>=2.0.0
    myst-parser>=3.0.0
    {toxinidir}/packages/agentic-crew
    {toxinidir}/packages/pytest-agentic-crew
commands =
    sphinx-build -b html docs docs/_build/html
